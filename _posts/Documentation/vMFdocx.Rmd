---
title: "vMF: An R Package for Fast Sampling from von Mises Fisher Distribution"
knit: (function(input_file, encoding) {
  out_dir <- 'docs';
  rmarkdown::render(input_file,
 encoding=encoding,
 output_file=file.path(dirname(input_file), out_dir, '2020-09-02-An-R-Package-for-Fast-Sampling-from-von-Mises-Fisher-Distribution.html'))})
author: "ElysÃ©e Aristide Houndetoungan"
date: "`r Sys.Date()`"
output:
  html_document:
    citation_package: natbib
    number_sections: true
  bookdown::pdf_book:
    citation_package: biblatex
bibliography: ["References.bib", "Packages.bib"]
biblio-style: "apalike"
link-citations: true
urlcolor: blue
vignette: >
  %\VignetteIndexEntry{vMFdocx}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

# Description

I build an R package named **vMF** that samples from von Mises-Fisher distribution. Unlike the [movMF](https://CRAN.R-project.org/package=movMF) package [@R-movMF] which also fits mixtures of von Mises-Fisher distrubution, **vFM** is focused on fast sampling from the distribution. This is useful for quickly performing high simulations in directional statistics. The package also calculates the density and the normalization constant of the von Mises-Fisher distribution.

Note that **vMF** does not substitute [movMF](https://CRAN.R-project.org/package=movMF) to the extent that [movMF](https://CRAN.R-project.org/package=movMF) handles many issues that **vMF** does not take into account. **vMF** can generate random vectors more quickly from the von Mises-Fisher distribution. I show in some examples below that **vMF** can be useful for directional statistical simulation questions.

# How to install vMF
The code source of the package is written in C++ with the package **Rcpp** [@R-Rcpp]. **vMF**  is currently available on GitHub. Its installation requires to prior install **devtools** package [@R-devtools]. Moreover, Windows users should install Rtools compatible with their R version.

**vMF** package can be installed from this GitHub repos using the `install_github` function of **devtools**. All the dependencies will also be installed automatically.

```{r install, echo = TRUE, eval = FALSE}
library(devtools) 
install_github("ahoundetoungan/vMF")
```
The option `build_vignettes = TRUE` can be added if one desires to install the vignettes (this will take several minutes)

## Examples
With [examples](https://github.com/ahoundetoungan/vMF/blob/master/Examples.R), I show how to use **vMF** and compare its performance with that of the package [movMF](https://CRAN.R-project.org/package=movMF).

```{r ex1, echo = TRUE, eval = TRUE}
library(vMF)
library(movMF)
library(rbenchmark) #For comparing elapsed time

benchmark("vMF" = rvMF(1,c(1,0,0)), "movMF" = rmovMF(1,c(1,0,0)), replications = 1000)

benchmark("vMF" = rvMF(100,c(1,0,0)), "movMF" = rmovMF(100,c(1,0,0)), replications = 1000)

benchmark("vMF" = rvMF(1000,c(1,0,0)), "movMF" = rmovMF(1000,c(1,0,0)), replications = 1000)
```

```{r ex2, echo = TRUE, eval = TRUE}
# Fonction based on vMF to simulate theta
SamplevMF          <-function(n, initial) {
  output           <-matrix(NaN, n + 1, length(initial))
  output[1, ]      <-t(initial)
  for (i in 1:n) {
    output[i + 1,] <-rvMF(1, output[i,])
  }
  return(output)
}

# Fonction based on movMF to simulate theta
SamplemovMF        <-function(n,initial){
  output           <-matrix(NaN, n + 1, length(initial))
  output[1, ]      <-initial
  for (i in 1:n) {
    output[i + 1,] <-rmovMF(1,output[i,])
  }
  return(output)
}
benchmark("vMF" = SamplevMF(1000,c(0,0,0,0)),
          "movMF" = SamplemovMF(1000,c(0,0,0,0)))
```